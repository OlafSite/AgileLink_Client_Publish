import{_ as ce,o as r,f as S,j as e,t as O,p as me,n as fe,e as Y,g as n,r as l,m as R,w as X,E as M,u as Ce,M as st,s as Oe,d as Te,i as W,h as g,y as F,N as nt,F as K,O as le,P as _t,Q as A,R as Ye,S as ot,T as xe,K as E,U as lt,V as rt,W as Se,X as it,Y as vt,B as je,Z as pt,b as gt,k as Fe,v as Ge,$ as mt,a0 as ft,a1 as ht}from"./index-4d5b55f1.js";import{F as ct}from"./FileSaver.min-eca27638.js";const yt=I=>(me("data-v-10fc9b27"),I=I(),fe(),I),bt={class:"container"},kt={class:"avatar"},St=["src"],$t=yt(()=>e("div",{class:"username"}," 我 ",-1)),wt={class:"talktext talk-bubble btn-4"},xt={__name:"bubbleSelf",props:{content:String,avatar:String},setup(I){const L=I;return(J,c)=>(r(),S("div",bt,[e("div",kt,[e("img",{src:L.avatar,alt:"Avatar"},null,8,St)]),$t,e("div",null,[e("div",wt,[e("p",null,O(L.content),1)])])]))}},qe=ce(xt,[["__scopeId","data-v-10fc9b27"]]);const Ct={class:"container"},Tt={class:"avatar"},It=["src"],Nt={class:"username"},Mt={class:"talktext talk-bubble btn-4"},Jt={__name:"bubble",props:{content:String,avatar:String,sender:String},setup(I){const L=I;return(J,c)=>(r(),S("div",Ct,[e("div",Tt,[e("img",{src:L.avatar,alt:"Avatar"},null,8,It)]),e("div",Nt,O(L.sender),1),e("div",null,[e("div",Mt,[e("p",null,O(L.content),1)])])]))}},We=ce(Jt,[["__scopeId","data-v-ed50e0ae"]]);const Ot=I=>(me("data-v-4c17cfc3"),I=I(),fe(),I),Lt={class:"container"},Rt={class:"avatar"},Ht=["src"],Ut=Ot(()=>e("div",{class:"username"}," 我 ",-1)),Dt={class:"talktext talk-bubble btn-4"},Vt={__name:"bubbleSelfPicture",props:{content:String,avatar:String},setup(I){const L=I;return(J,c)=>{const T=Y("el-image");return r(),S("div",Lt,[e("div",Rt,[e("img",{src:L.avatar,alt:"Avatar"},null,8,Ht)]),Ut,e("div",null,[e("div",Dt,[n(T,{style:{width:"100px",height:"100px"},src:L.content,"preview-src-list":[L.content],fit:"contain"},null,8,["src","preview-src-list"])])])])}}},Ke=ce(Vt,[["__scopeId","data-v-4c17cfc3"]]);const ut=I=>(me("data-v-c417d715"),I=I(),fe(),I),At={class:"container"},zt={class:"avatar"},Pt=["src"],Bt=ut(()=>e("div",{class:"username"}," 我 ",-1)),Ft={class:"talktext talk-bubble btn-4"},Gt={class:"folder-block"},Et={class:"icons"},jt=ut(()=>e("i",{title:"file"},null,-1)),Yt=[jt],qt={class:"folder-name"},Wt={__name:"bubbleSelfFile",props:{content:String,avatar:String},setup(I){const L=I,J=L.content.split("/"),c=l(decodeURIComponent(J[[J.length-1]]));function T($){R({url:$,method:"GET",responseType:"blob"}).then(y=>{const f=new Blob([y.data]);ct.saveAs(f,c.value)}).catch(y=>{console.error(y)})}return($,y)=>(r(),S("div",At,[e("div",zt,[e("img",{src:L.avatar,alt:"Avatar"},null,8,Pt)]),Bt,e("div",null,[e("div",Ft,[e("div",Gt,[e("div",Et,[e("div",{class:"icon icon--doc",onClick:y[0]||(y[0]=f=>T(L.content))},Yt)]),e("div",qt,O(c.value),1)])])])]))}},Qe=ce(Wt,[["__scopeId","data-v-c417d715"]]);const Kt={class:"container"},Qt={class:"avatar"},Xt=["src"],Zt={class:"username"},ea={class:"talktext talk-bubble btn-4"},ta={__name:"bubblePicture",props:{content:String,avatar:String},setup(I){const L=I;return(J,c)=>{const T=Y("el-image");return r(),S("div",Kt,[e("div",Qt,[e("img",{src:L.avatar,alt:"Avatar"},null,8,Xt)]),e("div",Zt,O(L.sender),1),e("div",null,[e("div",ea,[n(T,{style:{width:"100px",height:"100px"},src:L.content,"preview-src-list":[L.content],fit:"contain"},null,8,["src","preview-src-list"])])])])}}},Xe=ce(ta,[["__scopeId","data-v-467680e0"]]);const aa=I=>(me("data-v-d0533f81"),I=I(),fe(),I),sa={class:"container"},na={class:"avatar"},oa=["src"],la={class:"username"},ra={class:"talktext talk-bubble btn-4"},ia={class:"folder-block"},ca={class:"icons"},ua=aa(()=>e("i",{title:"file"},null,-1)),da=[ua],_a={class:"folder-name"},va={__name:"bubbleFile",props:{content:String,avatar:String},setup(I){const L=I,J=L.content.split("/"),c=l(decodeURIComponent(J[[J.length-1]]));function T($){R({url:$,method:"GET",responseType:"blob"}).then(y=>{const f=new Blob([y.data]);ct.saveAs(f,c.value)}).catch(y=>{console.error(y)})}return($,y)=>(r(),S("div",sa,[e("div",na,[e("img",{src:L.avatar,alt:"Avatar"},null,8,oa)]),e("div",la,O(L.sender),1),e("div",null,[e("div",ra,[e("div",ia,[e("div",ca,[e("div",{class:"icon icon--doc",onClick:y[0]||(y[0]=f=>T(L.content))},da)]),e("div",_a,O(c.value),1)])])])]))}},Ze=ce(va,[["__scopeId","data-v-d0533f81"]]);const Ue=I=>(me("data-v-9a9a257a"),I=I(),fe(),I),pa={class:"header"},ga={class:"more"},ma=Ue(()=>e("div",{class:"more-header"},"群聊成员",-1)),fa={class:"more-avatar"},ha=["src"],ya={class:"show-content"},ba={class:"show-content-top"},ka=["src"],Sa={class:"show-content-center"},$a={class:"show-group"},wa={class:"show-item"},xa={class:"show-item"},Ca={class:"show-item"},Ta={class:"show-item"},Ia=Ue(()=>e("hr",{style:{color:"#311c4b"}},null,-1)),Na={class:"show-button-content"},Ma=["onClick"],Ja={class:"more-name"},Oa=["onClick"],La={class:"at-avatar"},Ra=["src"],Ha={class:"at-name"},Ua={key:0,class:"at-name"},Da={class:"more-block"},Va=Ue(()=>e("div",{class:"more-name"}," 添加 ",-1)),Aa={class:"chatContainer"},za={style:{"min-height":"667px"}},Pa={class:"iconBox"},Ba=["onClick"],Fa={class:"at-avatar"},Ga=["src"],Ea={class:"at-name"},ja={class:"record-header"},Ya={style:{"min-height":"667px"}},qa={class:"iconBox"},Wa=["onMouseenter","onMouseleave"],Ka={class:"record-left"},Qa={class:"record-avatar"},Xa=["src"],Za={class:"record-right"},es={class:"record-time"},ts={class:"record-name"},as=Ue(()=>e("br",null,null,-1)),ss={key:0,class:"record-content"},ns={key:1,class:"record-content"},os={key:2,class:"record-content"},ls=["onClick"],Me=40,et="#/api/v1/team_manage/file_receive",rs={__name:"chat",setup(I){const L=()=>{J.value=y.value.wrapRef.scrollTop},J=l(Me),c=l(1);X(()=>J.value,(t,o)=>{console.log("chat"),t<=0&&(B.value=f.value,R({url:"#/api/v1/public_chat/get_new_messages",method:"post",data:JSON.stringify({token:u().token,type:c.value,type2:1,team_id:u().currentTeam.id,receive_user_id:_(),receive_group_id:_()*-1,time:b.value})}).then(s=>{console.log(b.value),console.log(s);let w=s.data.data.message_list;console.log(w),console.log("chat");for(let P of w)a.value.unshift(P);if(console.log(a),w.length!==0&&(b.value=a.value[0].time,V.value=a.value[a.value.length-1].time),w.length!==0){let P,i=5;P=setInterval(()=>{i--,i<=0&&(f.value=y.value.wrapRef.scrollHeight,y.value.setScrollTop(f.value-B.value),M.success("刷新成功"),clearInterval(P))},1)}else y.value.setScrollTop(Me),M.warning("没有新消息")}).catch(s=>{console.log(s)}))});const T=Ce(),$=l(u().user_id);X(()=>U(),(t,o)=>{if(console.log(t),ie.value=t.name,t.message_num===0)return;let s=t.newMessage;if(console.log(s,u()),s.sender_id===u().user_id){a.value.push(s),z(s.id),b.value=a.value[0].time,V.value=a.value[a.value.length-1].time,T.commit("updateChat",{id:_(),name:U().name,message_num:0,newMessage:U().newMessage});let w,P=20;w=setInterval(()=>{P--,P<=0&&(f.value=y.value.wrapRef.scrollHeight,y.value.setScrollTop(f.value),clearInterval(w))},1)}else if(s.sender_id===_()&&s.type===2||s.type===1&&_()===0||s.type===3&&_()===-1*s.receive_group_id){a.value.push(s),b.value=a.value[0].time,V.value=a.value[a.value.length-1].time,T.commit("updateChat",{id:_(),name:U().name,message_num:0,newMessage:U().newMessage});let w,P=20;w=setInterval(()=>{P--,P<=0&&(f.value=y.value.wrapRef.scrollHeight,y.value.setScrollTop(f.value),clearInterval(w))},1)}},{deep:!0});const y=l(null),f=l(0),B=l(0),G=l(null),a=l([]),b=l(ee()),V=l(ee());function j(){console.log(_()),console.log(U()),G.value=T.state.Chat.webSocket,a.value=[],b.value=ee(),V.value=ee(),console.log(u()),u().status===3&&(N.value=!0)}st((t,o,s)=>{R({url:"#/api/v1/public_chat/exit_chat",method:"post",data:JSON.stringify({token:u().token,type:c.value,team_id:u().currentTeam.id,receive_user_id:_(),receive_group_id:_()*-1})}).then(w=>{w.data.errno===0&&(M.info("离开当前聊天"),T.commit("backMain"),T.commit("changeCurrent",-1),console.log("chatCurrent",T.state.Chat.currentChatID),s())}).catch(w=>{console.log(w)})}),Oe(()=>{j(),ie.value=U().name,T.commit("updateChat",{id:_(),name:U().name,message_num:0,newMessage:U().newMessage}),_()===0?c.value=1:_()>0?c.value=2:c.value=3,R({url:"#/api/v1/public_chat/get_new_messages",method:"post",data:JSON.stringify({token:u().token,type:c.value,type2:1,team_id:u().currentTeam.id,receive_user_id:_(),receive_group_id:_()*-1,time:b.value})}).then(t=>{console.log(t.data.data.message_list);let o=t.data.data.message_list;for(let P of o)a.value.unshift(P);o.length!==0&&(b.value=a.value[0].time,V.value=a.value[a.value.length-1].time);let s,w=15;s=setInterval(()=>{w--,w<=0&&(clearInterval(s),f.value=y.value.wrapRef.scrollHeight,y.value.setScrollTop(f.value))},1)}).catch(t=>{console.log(t)})});function _(){return T.state.Chat.currentChatID}function U(){for(let t of T.getters.getChats)if(t.id===_())return t}X(()=>_(),(t,o)=>{if(o!==-1){let s;o===0?s=1:o>0?s=2:s=3,R({url:"#/api/v1/public_chat/exit_chat",method:"post",data:JSON.stringify({token:u().token,type:s,team_id:u().currentTeam.id,receive_user_id:o,receive_group_id:o*-1})}).then(w=>{w.data.errno===0&&M.info("离开当前聊天")}).catch(w=>{console.log(w)})}t!==-1&&(j(),ie.value=U().name,T.commit("updateChat",{id:_(),name:U().name,message_num:0,newMessage:U().newMessage}),t===0?c.value=1:t>0?c.value=2:c.value=3,R({url:"#/api/v1/public_chat/get_new_messages",method:"post",data:JSON.stringify({token:u().token,type:c.value,type2:1,team_id:u().currentTeam.id,receive_user_id:_(),receive_group_id:_()*-1,time:b.value})}).then(s=>{console.log(s);let w=s.data.data.message_list;for(let oe of w)a.value.unshift(oe);w.length!==0&&(b.value=a.value[0].time,V.value=a.value[a.value.length-1].time);let P,i=15;P=setInterval(()=>{i--,i<=0&&(f.value=y.value.wrapRef.scrollHeight,y.value.setScrollTop(f.value),clearInterval(P))},1)}).catch(s=>{console.log(s)}))},{deep:!0});function u(){return T.getters.getUserinfo}const Q=l(u().user_id);function ee(){const t=new Date,o=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),w=String(t.getDate()).padStart(2,"0"),P=String(t.getHours()).padStart(2,"0"),i=String(t.getMinutes()).padStart(2,"0"),oe=String(t.getSeconds()).padStart(2,"0"),ke=String(t.getMilliseconds()).padStart(3,"0");return`${o}-${s}-${w} ${P}:${i}:${oe}.${ke}`}const x=Te({content:"",atList:[],atPosition:-1}),se=l(!1),q=l(k());function D(t){x.content=x.content.slice(0,x.atPosition+1)+t.name+x.content.slice(x.atPosition+1,x.content.length),x.atList.push(t),se.value=!1}async function m(){await v(),se.value=!0}X(()=>x.content,(t,o)=>{if(t.length>o.length&&c.value!==2){for(let s=0;s<t.length&&s<o.length;s++)if(t[s]!==o[s]){t[s]==="@"&&(x.atPosition=s,m());break}t[t.length-1]==="@"&&(x.atPosition=t.length-1,m())}},{deep:!0});function k(){return T.getters.getMembers}function C(t){if(x.atList.length!==0){console.log({token:u().token,team_id:u().currentTeam.id,ated_user_id:C.id,content:x.content,message_source_id:t});for(let o of x.atList)c.value===1?o.id!==0?R({url:"#/api/v1/notice_center/team_at",method:"post",data:JSON.stringify({token:u().token,team_id:u().currentTeam.id,ated_user_id:o.id,content:x.content,message_source_id:t})}).then(s=>{console.log(s.data),s.data.errno===1009?M.info("对方未在线，将在上线时通知"):M.success("对方在线，已成功通知")}).catch(s=>{console.log(s)}):R({url:"#/api/v1/notice_center/team_at_all",method:"post",data:JSON.stringify({token:u().token,team_id:u().currentTeam.id,content:x.content,message_source_id:t})}).then(s=>{console.log(s.data),M.info("@全体成功")}).catch(s=>{console.log(s)}):o.id!==0?R({url:"#/api/v1/notice_center/group_at",method:"post",data:JSON.stringify({token:u().token,group_id:-1*_(),ated_user_id:o.id,content:x.content,message_source_id:t})}).then(s=>{console.log(s.data),s.data.errno===1009?M.info("对方未在线，将在上线时通知"):M.success("对方在线，已成功通知")}).catch(s=>{console.log(s)}):R({url:"#/api/v1/notice_center/group_at_all",method:"post",data:JSON.stringify({token:u().token,group_id:-1*_(),content:x.content,message_source_id:t})}).then(s=>{console.log(s.data),M.info("@全体成功")}).catch(s=>{console.log(s)})}}async function z(t){await C(t),x.content="",x.atList=[],x.atPosition=-1}function h(){G.value.send(JSON.stringify({type:c.value,content:x.content,sender_id:u().user_id,receive_team_id:u().currentTeam.id,receive_user_id:_(),receive_group_id:_()*-1})),M.success("发送成功")}const ne=l(null),H=l(null),te=l("false"),Le=t=>{H.value=t.raw},De=t=>{t.type==="image/jpeg"||t.type==="image/png"?te.value="true":te.value="false"};function Ve(t){T.commit("changeCurrent",t.id)}function Ae(){const t=new FormData;t.append("token",u().token),t.append("file",H.value),R.post(et,t).then(o=>{ze(o.data)}).catch(o=>{he(o)})}const ze=t=>{console.log(t.data.url),G.value.send(JSON.stringify({type:c.value,content:te.value,sender_id:u().user_id,file_content:decodeURI(t.data.url),receive_team_id:u().currentTeam.id,receive_user_id:_(),receive_group_id:_()*-1})),M.success("文件发送成功")},he=t=>{console.log(t)},ye=l(!1);function be(){ye.value=!0;let t,o=15;t=setInterval(()=>{o--,o<=0&&(re.value.setScrollTop(re.value.wrapRef.scrollHeight),clearInterval(t))},1)}const ie=l(""),ae=l(""),de=l(JSON.parse(JSON.stringify(a.value)));function Pe(){ae.value="",ye.value=!1,de.value=JSON.parse(JSON.stringify(a.value))}X(()=>ae.value,(t,o)=>{ae.value===""&&(ge.value=ee())},{deep:!0});function $e(){if(ae.value===""){M.error("关键字不能为空");return}R({url:"#/api/v1/public_chat/search_message",method:"post",data:JSON.stringify({token:u().token,type:c.value,team_id:u().currentTeam.id,receive_user_id:_(),group_id:_()*-1,time:ge.value,keyword:ae.value})}).then(t=>{let o=t.data.data.message_list;console.log(o),de.value=[];for(let s of o)de.value.push(s);if(o.length!==0&&(ge.value=de.value[0].time),o.length!==0){let s,w=5;s=setInterval(()=>{w--,w<=0&&(Z.value=re.value.wrapRef.scrollHeight,re.value.setScrollTop(Z.value),M.success("刷新成功"),clearInterval(s))},1)}})}X(()=>a.value,(t,o)=>{ae.value===""&&(de.value=JSON.parse(JSON.stringify(t)))},{deep:!0});const ge=l(ee()),we=l(Me),_e=l(0),Z=l(0),re=l(null),Be=()=>{we.value=re.value.wrapRef.scrollTop};X(()=>we.value,(t,o)=>{t<=0&&(_e.value=re.value.wrapRef.scrollHeight,B.value=f.value,ae.value===""?R({url:"#/api/v1/public_chat/get_new_messages",method:"post",data:JSON.stringify({token:u().token,type:c.value,type2:1,team_id:u().currentTeam.id,receive_user_id:_(),receive_group_id:_()*-1,time:b.value})}).then(s=>{console.log(b.value),console.log(s);let w=s.data.data.message_list;console.log(w);for(let P of w)a.value.unshift(P);if(w.length!==0&&(b.value=a.value[0].time,V.value=a.value[a.value.length-1].time),w.length!==0){let P,i=5;P=setInterval(()=>{i--,i<=0&&(f.value=y.value.wrapRef.scrollHeight,Z.value=re.value.wrapRef.scrollHeight,re.value.setScrollTop(Z.value-_e.value),y.value.setScrollTop(f.value),M.success("刷新成功"),clearInterval(P))},1)}else f.value=y.value.wrapRef.scrollHeight,y.value.setScrollTop(f.value),re.value.setScrollTop(Me),M.error("没有新的相关消息")}).catch(s=>{console.log(s)}):R({url:"#/api/v1/public_chat/search_message",method:"post",data:JSON.stringify({token:u().token,type:c.value,team_id:u().currentTeam.id,receive_user_id:_(),group_id:_()*-1,time:ge.value,keyword:ae.value})}).then(s=>{let w=s.data.data.message_list;console.log(w);for(let P of w)de.value.unshift(P);if(w.length!==0&&(ge.value=de.value[0].time),w.length!==0){let P,i=5;P=setInterval(()=>{i--,i<=0&&(Z.value=re.value.wrapRef.scrollHeight,re.value.setScrollTop(Z.value-_e.value),M.success("刷新成功"),clearInterval(P))},1)}else re.value.setScrollTop(Me),M.error("没有新信息")}))});function ve(t){T.commit("goTemplate",t)}function Re(t){for(let o of ue.value)if(o.id===t.id)return!1;return!0}const ue=l([]);function v(){if(c.value===1)ue.value=JSON.parse(JSON.stringify(k()));else if(c.value===2){ue.value=[];let t=[];t.push(_()),t.push(u().user_id),R({url:"#/api/v1/team_manage/user/get_user_info",method:"post",data:JSON.stringify({token:u().token,user_list:t})}).then(o=>{let s=o.data.data;for(let w of s)ue.value.push({id:w.user_id,name:w.username,avatar:w.avatar,status:1})}).catch(o=>{console.log(o)})}else R({url:"#/api/v1/public_chat/group/get_group_member_list",method:"post",data:JSON.stringify({token:u().token,group_id:_()*-1})}).then(t=>{ue.value=[];let o=t.data.data;for(let s of o)ue.value.push({id:s.user_id,name:s.user_name,avatar:s.user_avatar,status:s.status})}).catch(t=>{console.log(t)})}const N=l(!1);function d(t){R({url:"#/api/v1/public_chat/group/invite_member",method:"post",data:JSON.stringify({token:u().token,team_id:u().currentTeam.id,group_id:_()*-1,invitee_id:t})}).then(o=>{o.data.errno===0?M.success("邀请成功"):o.data.errno===1006?M.info("已在群组中"):o.data.errno===1007&&M.info("邀请成功，但被邀请人不在线"),k()}).catch(o=>{console.log(o)})}return(t,o)=>{const s=Y("el-popover"),w=Y("el-icon"),P=Y("el-scrollbar"),i=Y("el-upload"),oe=Y("el-input"),ke=Y("el-dialog");return r(),S(K,null,[e("div",pa,[W(O(ie.value)+" ",1),n(s,{trigger:"click",placement:"left-end",width:300},{reference:g(()=>[n(w,{class:"more-icon",onClick:v},{default:g(()=>[n(F(nt))]),_:1})]),default:g(()=>[e("div",ga,[ma,(r(!0),S(K,null,le(ue.value,(p,pe)=>(r(),S("div",{key:pe,class:"more-block"},[n(s,{width:300,placement:"left-start","popper-style":"box-shadow: rgb(14 18 22 / 35%) 0px 10px 38px -10px, rgb(14 18 22 / 20%) 0px 10px 20px -15px; padding: 20px;",trigger:"click"},{reference:g(()=>[e("div",fa,[e("img",{class:"more-avatar-img",src:p.avatar,alt:""},null,8,ha)])]),default:g(()=>[e("div",ya,[e("div",ba,[e("img",{style:{"margin-bottom":"8px"},src:p.avatar,class:"show-img",alt:""},null,8,ka)]),e("div",Sa,[e("ul",$a,[e("li",wa,"昵称："+O(p.nickname),1),e("li",xa,"姓名："+O(p.name),1),e("li",Ca,"身份：团队"+O(p.status),1),e("li",Ta,"邮件："+O(p.email),1)])]),Ia,e("div",Na,[e("button",{class:"show-content-send-single-button",onClick:Ne=>Ve(p)},"发消息",8,Ma)])])]),_:2},1024),e("div",Ja,O(p.name),1)]))),128)),n(s,{placement:"bottom",width:200,trigger:"click"},_t({default:g(()=>[(r(!0),S(K,null,le(q.value,(p,pe)=>(r(),S("div",{key:pe},[Re(p)?(r(),S("div",{key:0,class:"at-block",onClick:Ne=>d(p.id)},[e("div",La,[e("img",{style:{height:"30px",width:"30px","border-radius":"50%"},src:p.avatar,alt:"Avatar"},null,8,Ra)]),e("div",Ha,O(p.name),1)],8,Oa)):A("",!0)]))),128)),q.value.length===ue.value.length?(r(),S("div",Ua," 无可邀请成员 ")):A("",!0)]),_:2},[c.value===3?{name:"reference",fn:g(()=>[e("div",Da,[n(w,null,{default:g(()=>[n(F(Ye),{class:"more-icon-circle"})]),_:1}),Va])]),key:"0"}:void 0]),1024),e("div",{class:"more-record",onClick:o[0]||(o[0]=p=>ye.value=!0)},[W(" 聊天记录 "),n(w,null,{default:g(()=>[n(F(ot),{class:"more-icon-arrow"})]),_:1})])])]),_:1})]),e("div",Aa,[n(P,{style:{"max-height":"100%",height:"625px","min-height":"200px","border-bottom":"1.5px solid rgb(220, 220, 220)"},"wrap-class":"scroll-wrap",ref_key:"scrollContainer",ref:y,onScroll:L},{default:g(()=>[e("div",za,[e("div",Pa,[n(w,{class:"is-loading"},{default:g(()=>[n(F(xe))]),_:1})]),(r(!0),S(K,null,le(a.value,(p,pe)=>(r(),S("div",{key:pe,class:"rightContainer"},[p.sender_id===$.value&&p.file_content==""?(r(),E(qe,{key:0,content:p.content,avatar:p.sender_avatar,sender:p.sender_name},null,8,["content","avatar","sender"])):A("",!0),p.sender_id!==$.value&&p.file_content==""?(r(),E(We,{key:1,content:p.content,avatar:p.sender_avatar,sender:p.sender_name},null,8,["content","avatar","sender"])):A("",!0),p.sender_id===$.value&&p.file_content!==""&&p.content==="true"?(r(),E(Ke,{key:2,content:p.file_content,avatar:p.sender_avatar,sender:p.sender_name},null,8,["content","avatar","sender"])):A("",!0),p.sender_id===$.value&&p.file_content!==""&&p.content==="false"?(r(),E(Qe,{key:3,content:p.file_content,avatar:p.sender_avatar,sender:p.sender_name},null,8,["content","avatar","sender"])):A("",!0),p.sender_id!==$.value&&p.file_content!==""&&p.content==="true"?(r(),E(Xe,{key:4,content:p.file_content,avatar:p.sender_avatar,sender:p.sender_name},null,8,["content","avatar","sender"])):A("",!0),p.sender_id!==$.value&&p.file_content!==""&&p.content==="false"?(r(),E(Ze,{key:5,content:p.file_content,avatar:p.sender_avatar,sender:p.sender_name},null,8,["content","avatar","sender"])):A("",!0)]))),128))])]),_:1},512),e("div",null,[n(i,{ref_key:"upLoads",ref:ne,class:"avatar-uploader",action:et,"http-request":Ae,"on-change":Le,"show-file-list":!1,"before-upload":De},{trigger:g(()=>[n(w,{style:{"font-size":"25px","margin-left":"30px","margin-top":"10px"}},{default:g(()=>[n(F(lt))]),_:1})]),default:g(()=>[n(w,{style:{"font-size":"25px","margin-left":"20px","margin-top":"10px"}},{default:g(()=>[n(F(rt),{onClick:be,style:{cursor:"pointer"}})]),_:1}),n(s,{visible:se.value,placement:"top-start",width:200},{reference:g(()=>[n(F(Se),{icon:["fas","at"],style:{"font-size":"23px","margin-left":"20px","margin-bottom":"3px"}})]),default:g(()=>[e("div",{class:"at-block",onClick:o[1]||(o[1]=p=>D({name:"所有人",id:0}))},"所有人"),(r(!0),S(K,null,le(ue.value.filter(p=>p.id!==Q.value),(p,pe)=>(r(),S("div",{onClick:Ne=>D(p),key:pe,class:"at-block"},[e("div",Fa,[e("img",{style:{height:"30px",width:"30px","border-radius":"50%"},src:p.avatar,alt:"Avatar"},null,8,Ga)]),e("div",Ea,O(p.name),1)],8,Ba))),128))]),_:1},8,["visible"])]),_:1},512)]),e("div",null,[n(oe,{type:"textarea",rows:6,placeholder:"请输入内容",modelValue:x.content,"onUpdate:modelValue":o[2]||(o[2]=p=>x.content=p),resize:"none",style:{position:"relative",top:"5px"}},null,8,["modelValue"]),e("div",{class:"send",onClick:h}," 发送 ")])]),n(ke,{modelValue:ye.value,"onUpdate:modelValue":o[4]||(o[4]=p=>ye.value=p),width:"40%","before-close":Pe},{header:g(()=>[e("div",ja,O(ie.value),1)]),default:g(()=>[n(oe,{modelValue:ae.value,"onUpdate:modelValue":o[3]||(o[3]=p=>ae.value=p),placeholder:"请输入搜索内容",clearable:"",style:{"font-size":"16px",position:"relative",top:"-20px"},size:"large"},{append:g(()=>[n(w,null,{default:g(()=>[n(F(it),{onClick:$e,circle:"",style:{cursor:"pointer"}})]),_:1})]),_:1},8,["modelValue"]),n(P,{style:{"max-height":"100%",height:"600px","min-height":"200px","border-bottom":"1.5px solid rgb(220, 220, 220)"},"wrap-class":"scroll-wrap",ref_key:"scrollSearchContainer",ref:re,onScroll:Be},{default:g(()=>[e("div",Ya,[e("div",qa,[n(w,{class:"is-loading"},{default:g(()=>[n(F(xe))]),_:1})]),(r(!0),S(K,null,le(de.value,(p,pe)=>(r(),S("div",{key:pe,class:"record-block",onMouseenter:Ne=>p.record_visible=!0,onMouseleave:Ne=>p.record_visible=!1},[e("div",Ka,[e("div",Qa,[e("img",{style:{height:"30px",width:"30px","border-radius":"50%"},src:p.sender_avatar,alt:"Avatar"},null,8,Xa)])]),e("div",Za,[e("div",es,O(p.time),1),e("div",ts,O(p.sender_name),1),as,p.file_content!=""&&p.content=="true"?(r(),S("div",ss,"[图片]")):p.file_content!=""&&p.content=="false"?(r(),S("div",ns,"[文件]")):(r(),S("div",os,O(p.content),1)),p.record_visible?(r(),S("div",{key:3,class:"record-go",onClick:Ne=>ve(p)},"查看上下文",8,ls)):A("",!0)])],40,Wa))),128))])]),_:1},512)]),_:1},8,["modelValue"])],64)}}},is=ce(rs,[["__scopeId","data-v-9a9a257a"]]);const cs={class:"header"},us={class:"chatContainer"},ds={class:"iconBox"},_s={style:{"min-height":"860px"}},vs={class:"iconBox"},He=40,ps={__name:"templateChat",setup(I){const L=()=>{c.value=f.value.wrapRef.scrollTop},J=Ce(),c=l(He),T=l(u().name),$=l(1);X(()=>c.value,(m,k)=>{m<=0&&(G.value=B.value,R({url:"#/api/v1/public_chat/get_new_messages",method:"post",data:JSON.stringify({token:Q().token,type:$.value,type2:1,team_id:Q().currentTeam.id,receive_user_id:U(),receive_group_id:U()*-1,time:V.value})}).then(C=>{console.log(C);let z=C.data.data.message_list;console.log(z);for(let h of z)b.value.unshift(h);if(console.log(b),z.length!==0&&(V.value=b.value[0].time,j.value=b.value[b.value.length-1].time),z.length!==0){let h,ne=5;h=setInterval(()=>{ne--,ne<=0&&(B.value=f.value.wrapRef.scrollHeight,f.value.setScrollTop(B.value-G.value),M.success("刷新成功"),clearInterval(h))},1)}else f.value.setScrollTop(He),M.warning("没有新消息")}).catch(C=>{console.log(C)}))});const y=l(!0);X(()=>c.value,(m,k)=>{console.log(m+781),console.log(f.value.wrapRef.scrollHeight),m+781>=f.value.wrapRef.scrollHeight&&y.value===!0&&(y.value=!1,G.value=B.value,R({url:"#/api/v1/public_chat/get_new_messages",method:"post",data:JSON.stringify({token:Q().token,type:$.value,type2:2,team_id:Q().currentTeam.id,receive_user_id:U(),receive_group_id:U()*-1,time:j.value})}).then(C=>{let z=C.data.data.message_list;z.length!==0&&z[0].id===b.value[b.value.length-1].id&&(z.shift(),console.log(z));for(let h of z)b.value.push(h);if(console.log(b),z.length!==0&&(V.value=b.value[0].time,j.value=b.value[b.value.length-1].time),z.length!==0){let h,ne=5;h=setInterval(()=>{ne--,ne<=0&&(B.value=f.value.wrapRef.scrollHeight,f.value.setScrollTop(m),y.value=!0,M.success("刷新成功"),clearInterval(h))},1)}else y.value=!0,f.value.setScrollTop(f.value.wrapRef.scrollHeight-780-He),M.warning("没有新消息")}).catch(C=>{console.log(C)}))});const f=l(null),B=l(0),G=l(0),a=l(null),b=l([]),V=l(ee()),j=l(ee());function _(){$.value=J.state.Chat.fixedMessage.type,a.value=J.state.Chat.webSocket,b.value=[],b.value.push(J.state.Chat.fixedMessage),V.value=J.state.Chat.fixedMessage.time,j.value=J.state.Chat.fixedMessage.time}Oe(()=>{_(),R({url:"#/api/v1/public_chat/get_new_messages",method:"post",data:JSON.stringify({token:Q().token,type:$.value,type2:2,team_id:Q().currentTeam.id,receive_user_id:U(),receive_group_id:U()*-1,time:j.value})}).then(m=>{console.log(m);let k=m.data.data.message_list;for(let h of k)b.value.push(h);k.length!==0&&(V.value=b.value[0].time,j.value=b.value[b.value.length-1].time);let C,z=15;C=setInterval(()=>{z--,z<=0&&(B.value=f.value.wrapRef.scrollHeight,f.value.setScrollTop(He),clearInterval(C))},1)}).catch(m=>{console.log(m)})});function U(){return J.state.Chat.currentChatID}function u(){for(let m of J.getters.getChats)if(m.id===U())return m}function Q(){return J.getters.getUserinfo}function ee(){const m=new Date,k=m.getFullYear(),C=String(m.getMonth()+1).padStart(2,"0"),z=String(m.getDate()).padStart(2,"0"),h=String(m.getHours()).padStart(2,"0"),ne=String(m.getMinutes()).padStart(2,"0"),H=String(m.getSeconds()).padStart(2,"0"),te=String(m.getMilliseconds()).padStart(3,"0");return`${k}-${C}-${z} ${h}:${ne}:${H}.${te}`}const x=Te({content:"",atList:[],atPosition:-1}),se=l(!1);l(q()),X(()=>x.content,(m,k)=>{if(m.length>k.length){for(let C=0;C<m.length&&C<k.length;C++)if(m[C]!==k[C]){m[C]==="@"&&(x.atPosition=C,se.value=!0);break}m[m.length-1]==="@"&&(x.atPosition=m.length-1,se.value=!0)}},{deep:!0});function q(){return J.getters.getMembers}function D(){J.commit("backMain")}return(m,k)=>{const C=Y("el-icon"),z=Y("el-scrollbar");return r(),S(K,null,[e("div",cs,[W(O(T.value)+" | 历史消息 ",1),e("div",{class:"back-icon",onClick:D},[n(C,null,{default:g(()=>[n(F(vt))]),_:1})])]),e("div",us,[n(z,{style:{height:"780px","border-bottom":"1.5px solid rgb(220, 220, 220)"},"wrap-class":"scroll-wrap",ref_key:"scrollContainer",ref:f,onScroll:L},{default:g(()=>[e("div",ds,[n(C,{class:"is-loading"},{default:g(()=>[n(F(xe))]),_:1})]),e("div",_s,[(r(!0),S(K,null,le(b.value,(h,ne)=>(r(),S("div",{key:ne,class:"rightContainer"},[h.sender_id===m.userId&&h.file_content==""?(r(),E(qe,{key:0,content:h.content,avatar:h.sender_avatar,sender:h.sender_name},null,8,["content","avatar","sender"])):A("",!0),h.sender_id!==m.userId&&h.file_content==""?(r(),E(We,{key:1,content:h.content,avatar:h.sender_avatar,sender:h.sender_name},null,8,["content","avatar","sender"])):A("",!0),h.sender_id===m.userId&&h.file_content!==""&&h.content==="true"?(r(),E(Ke,{key:2,content:h.file_content,avatar:h.sender_avatar,sender:h.sender_name},null,8,["content","avatar","sender"])):A("",!0),h.sender_id===m.userId&&h.file_content!==""&&h.content==="false"?(r(),E(Qe,{key:3,content:h.file_content,avatar:h.sender_avatar,sender:h.sender_name},null,8,["content","avatar","sender"])):A("",!0),h.sender_id!==m.userId&&h.file_content!==""&&h.content==="true"?(r(),E(Xe,{key:4,content:h.file_content,avatar:h.sender_avatar,sender:h.sender_name},null,8,["content","avatar","sender"])):A("",!0),h.sender_id!==m.userId&&h.file_content!==""&&h.content==="false"?(r(),E(Ze,{key:5,content:h.file_content,avatar:h.sender_avatar,sender:h.sender_name},null,8,["content","avatar","sender"])):A("",!0)]))),128))]),e("div",vs,[n(C,{class:"is-loading"},{default:g(()=>[n(F(xe))]),_:1})])]),_:1},512)])],64)}}},gs=ce(ps,[["__scopeId","data-v-c1a05180"]]),ms=""+new URL("vue-5532db34.svg",import.meta.url).href;const Ie=I=>(me("data-v-21c304b7"),I=I(),fe(),I),fs={class:"header"},hs={class:"more"},ys=Ie(()=>e("div",{class:"more-header"},"群聊成员",-1)),bs={class:"more-avatar"},ks=["src"],Ss={class:"show-content"},$s={class:"show-content-top"},ws=["src"],xs={class:"show-content-center"},Cs={class:"show-group"},Ts={class:"show-item"},Is={class:"show-item"},Ns={class:"show-item"},Ms={class:"show-item"},Js=Ie(()=>e("hr",{style:{color:"#311c4b"}},null,-1)),Os=Ie(()=>e("div",{class:"show-button-content"},[e("button",{class:"show-content-send-single-button"},"发消息")],-1)),Ls={class:"more-name"},Rs=Ie(()=>e("div",{class:"at-avatar"},[e("img",{src:ms,alt:"Avatar"})],-1)),Hs={class:"at-name"},Us={class:"more-block"},Ds=Ie(()=>e("div",{class:"more-name"}," 添加 ",-1)),Vs={class:"chatContainer"},As={style:{"min-height":"667px"}},zs={class:"iconBox"},Ps=["onClick"],Bs={class:"at-avatar"},Fs=["src"],Gs={class:"at-name"},Es={class:"record-header"},js={style:{"min-height":"667px"}},Ys={class:"iconBox"},qs=["onMouseenter","onMouseleave"],Ws={class:"record-left"},Ks={class:"record-avatar"},Qs=["src"],Xs={class:"record-right"},Zs={class:"record-time"},en={class:"record-name"},tn=Ie(()=>e("br",null,null,-1)),an={key:0,class:"record-content"},sn={key:1,class:"record-content"},nn={key:2,class:"record-content"},on=["onClick"],Je=40,tt="#/api/v1/team_manage/file_receive",ln={__name:"chatExpand",setup(I){const L=()=>{J.value=y.value.wrapRef.scrollTop},J=l(Je),c=l(1);X(()=>J.value,(v,N)=>{console.log("chat"),v<=0&&(B.value=f.value,R({url:"#/api/v1/public_chat/get_new_messages",method:"post",data:JSON.stringify({token:u().token,type:c.value,type2:1,team_id:u().currentTeam.id,receive_user_id:_(),receive_group_id:_()*-1,time:b.value})}).then(d=>{console.log(b.value),console.log(d);let t=d.data.data.message_list;console.log(t),console.log("chat");for(let o of t)a.value.unshift(o);if(console.log(a),t.length!==0&&(b.value=a.value[0].time,V.value=a.value[a.value.length-1].time),t.length!==0){let o,s=5;o=setInterval(()=>{s--,s<=0&&(f.value=y.value.wrapRef.scrollHeight,y.value.setScrollTop(f.value-B.value),M.success("刷新成功"),clearInterval(o))},1)}else y.value.setScrollTop(Je),M.warning("没有新消息")}).catch(d=>{console.log(d)}))});const T=Ce(),$=l(u().user_id);X(()=>U(),(v,N)=>{if(console.log(v),be.value=v.name,v.message_num===0)return;let d=v.newMessage;if(console.log(d,u()),d.sender_id===u().user_id){a.value.push(d),z(d.id),b.value=a.value[0].time,V.value=a.value[a.value.length-1].time,T.commit("updateChat",{id:_(),name:U().name,message_num:0,newMessage:U().newMessage});let t,o=20;t=setInterval(()=>{o--,o<=0&&(f.value=y.value.wrapRef.scrollHeight,y.value.setScrollTop(f.value),clearInterval(t))},1)}else if(d.sender_id===_()&&d.type===2||d.type===1&&_()===0||d.type===3&&_()===-1*d.receive_group_id){a.value.push(d),b.value=a.value[0].time,V.value=a.value[a.value.length-1].time,T.commit("updateChat",{id:_(),name:U().name,message_num:0,newMessage:U().newMessage});let t,o=20;t=setInterval(()=>{o--,o<=0&&(f.value=y.value.wrapRef.scrollHeight,y.value.setScrollTop(f.value),clearInterval(t))},1)}},{deep:!0});const y=l(null),f=l(0),B=l(0),G=l(null),a=l([]),b=l(ee()),V=l(ee());function j(){console.log(_()),console.log(U()),G.value=T.state.Chat.webSocket,a.value=[],b.value=ee(),V.value=ee(),console.log(u()),u().status===3&&(ue.value=!0)}st((v,N,d)=>{R({url:"#/api/v1/public_chat/exit_chat",method:"post",data:JSON.stringify({token:u().token,type:c.value,team_id:u().currentTeam.id,receive_user_id:_(),receive_group_id:_()*-1})}).then(t=>{t.data.errno===0&&(M.info("离开当前聊天"),T.commit("backMain"),T.commit("changeCurrent",-1),console.log("chatCurrent",T.state.Chat.currentChatID),d())}).catch(t=>{console.log(t)})}),Oe(()=>{j(),be.value=U().name,T.commit("updateChat",{id:_(),name:U().name,message_num:0,newMessage:U().newMessage}),_()===0?c.value=1:_()>0?c.value=2:c.value=3,R({url:"#/api/v1/public_chat/get_new_messages",method:"post",data:JSON.stringify({token:u().token,type:c.value,type2:1,team_id:u().currentTeam.id,receive_user_id:_(),receive_group_id:_()*-1,time:b.value})}).then(v=>{console.log(v.data.data.message_list);let N=v.data.data.message_list;for(let o of N)a.value.unshift(o);N.length!==0&&(b.value=a.value[0].time,V.value=a.value[a.value.length-1].time);let d,t=15;d=setInterval(()=>{t--,t<=0&&(f.value=y.value.wrapRef.scrollHeight,y.value.setScrollTop(f.value),clearInterval(d))},1)}).catch(v=>{console.log(v)})});function _(){return T.state.Chat.currentChatID}function U(){for(let v of T.getters.getChats)if(v.id===_())return v}X(()=>_(),(v,N)=>{if(N!==-1){let d;N===0?d=1:N>0?d=2:d=3,R({url:"#/api/v1/public_chat/exit_chat",method:"post",data:JSON.stringify({token:u().token,type:d,team_id:u().currentTeam.id,receive_user_id:N,receive_group_id:N*-1})}).then(t=>{t.data.errno===0&&M.info("离开当前聊天")}).catch(t=>{console.log(t)})}v!==-1&&(j(),be.value=U().name,T.commit("updateChat",{id:_(),name:U().name,message_num:0,newMessage:U().newMessage}),v===0?c.value=1:v>0?c.value=2:c.value=3,R({url:"#/api/v1/public_chat/get_new_messages",method:"post",data:JSON.stringify({token:u().token,type:c.value,type2:1,team_id:u().currentTeam.id,receive_user_id:_(),receive_group_id:_()*-1,time:b.value})}).then(d=>{console.log(d);let t=d.data.data.message_list;for(let w of t)a.value.unshift(w);t.length!==0&&(b.value=a.value[0].time,V.value=a.value[a.value.length-1].time);let o,s=15;o=setInterval(()=>{s--,s<=0&&(f.value=y.value.wrapRef.scrollHeight,y.value.setScrollTop(f.value),clearInterval(o))},1)}).catch(d=>{console.log(d)}))},{deep:!0});function u(){return T.getters.getUserinfo}const Q=l(u().user_id);function ee(){const v=new Date,N=v.getFullYear(),d=String(v.getMonth()+1).padStart(2,"0"),t=String(v.getDate()).padStart(2,"0"),o=String(v.getHours()).padStart(2,"0"),s=String(v.getMinutes()).padStart(2,"0"),w=String(v.getSeconds()).padStart(2,"0"),P=String(v.getMilliseconds()).padStart(3,"0");return`${N}-${d}-${t} ${o}:${s}:${w}.${P}`}const x=Te({content:"",atList:[],atPosition:-1}),se=l(!1),q=l(k());function D(v){x.content=x.content.slice(0,x.atPosition+1)+v.name+x.content.slice(x.atPosition+1,x.content.length),x.atList.push(v),se.value=!1}async function m(){await Re(),se.value=!0}X(()=>x.content,(v,N)=>{if(v.length>N.length&&c.value!==2){for(let d=0;d<v.length&&d<N.length;d++)if(v[d]!==N[d]){v[d]==="@"&&(x.atPosition=d,m());break}v[v.length-1]==="@"&&(x.atPosition=v.length-1,m())}},{deep:!0});function k(){return T.getters.getMembers}function C(v){if(x.atList.length!==0){console.log({token:u().token,team_id:u().currentTeam.id,ated_user_id:C.id,content:x.content,message_source_id:v});for(let N of x.atList)c.value===1?N.id!==0?R({url:"#/api/v1/notice_center/team_at",method:"post",data:JSON.stringify({token:u().token,team_id:u().currentTeam.id,ated_user_id:N.id,content:x.content,message_source_id:v})}).then(d=>{console.log(d.data),d.data.errno===1009?M.info("对方未在线，将在上线时通知"):M.success("对方在线，已成功通知")}).catch(d=>{console.log(d)}):R({url:"#/api/v1/notice_center/team_at_all",method:"post",data:JSON.stringify({token:u().token,team_id:u().currentTeam.id,content:x.content,message_source_id:v})}).then(d=>{console.log(d.data),M.info("@全体成功")}).catch(d=>{console.log(d)}):N.id!==0?R({url:"#/api/v1/notice_center/group_at",method:"post",data:JSON.stringify({token:u().token,group_id:-1*_(),ated_user_id:N.id,content:x.content,message_source_id:v})}).then(d=>{console.log(d.data),d.data.errno===1009?M.info("对方未在线，将在上线时通知"):M.success("对方在线，已成功通知")}).catch(d=>{console.log(d)}):R({url:"#/api/v1/notice_center/group_at_all",method:"post",data:JSON.stringify({token:u().token,group_id:-1*_(),content:x.content,message_source_id:v})}).then(d=>{console.log(d.data),M.info("@全体成功")}).catch(d=>{console.log(d)})}}async function z(v){await C(v),x.content="",x.atList=[],x.atPosition=-1}function h(){G.value.send(JSON.stringify({type:c.value,content:x.content,sender_id:u().user_id,receive_team_id:u().currentTeam.id,receive_user_id:_(),receive_group_id:_()*-1})),M.success("发送成功")}const ne=l(null),H=l(null),te=l("false"),Le=v=>{H.value=v.raw},De=v=>{v.type==="image/jpeg"||v.type==="image/png"?te.value="true":te.value="false"};function Ve(){const v=new FormData;v.append("token",u().token),v.append("file",H.value),R.post(tt,v).then(N=>{Ae(N.data)}).catch(N=>{ze(N)})}const Ae=v=>{console.log(v.data.url),G.value.send(JSON.stringify({type:c.value,content:te.value,sender_id:u().user_id,file_content:decodeURI(v.data.url),receive_team_id:u().currentTeam.id,receive_user_id:_(),receive_group_id:_()*-1})),M.success("文件发送成功")},ze=v=>{console.log(v)},he=l(!1);function ye(){he.value=!0;let v,N=15;v=setInterval(()=>{N--,N<=0&&(Z.value.setScrollTop(Z.value.wrapRef.scrollHeight),clearInterval(v))},1)}const be=l(""),ie=l(""),ae=l(JSON.parse(JSON.stringify(a.value)));function de(){ie.value="",he.value=!1,ae.value=JSON.parse(JSON.stringify(a.value))}function Pe(){if(ie.value===""){M.error("关键字不能为空");return}R({url:"#/api/v1/public_chat/search_message",method:"post",data:JSON.stringify({token:u().token,type:c.value,team_id:u().currentTeam.id,receive_user_id:_(),group_id:_()*-1,time:$e.value,keyword:ie.value})}).then(v=>{let N=v.data.data.message_list;console.log(N),ae.value=[];for(let d of N)ae.value.push(d);if(N.length!==0&&($e.value=ae.value[0].time),N.length!==0){let d,t=5;d=setInterval(()=>{t--,t<=0&&(_e.value=Z.value.wrapRef.scrollHeight,Z.value.setScrollTop(_e.value),M.success("刷新成功"),clearInterval(d))},1)}})}X(()=>a.value,(v,N)=>{ie.value===""&&(ae.value=JSON.parse(JSON.stringify(v)))},{deep:!0});const $e=l(ee()),ge=l(Je),we=l(0),_e=l(0),Z=l(null),re=()=>{ge.value=Z.value.wrapRef.scrollTop};X(()=>ge.value,(v,N)=>{v<=0&&(we.value=Z.value.wrapRef.scrollHeight,B.value=f.value,ie.value===""?R({url:"#/api/v1/public_chat/get_new_messages",method:"post",data:JSON.stringify({token:u().token,type:c.value,type2:1,team_id:u().currentTeam.id,receive_user_id:_(),receive_group_id:_()*-1,time:b.value})}).then(d=>{console.log(b.value),console.log(d);let t=d.data.data.message_list;console.log(t);for(let o of t)a.value.unshift(o);if(t.length!==0&&(b.value=a.value[0].time,V.value=a.value[a.value.length-1].time),t.length!==0){let o,s=5;o=setInterval(()=>{s--,s<=0&&(f.value=y.value.wrapRef.scrollHeight,_e.value=Z.value.wrapRef.scrollHeight,Z.value.setScrollTop(_e.value-we.value),y.value.setScrollTop(f.value),M.success("刷新成功"),clearInterval(o))},1)}else f.value=y.value.wrapRef.scrollHeight,y.value.setScrollTop(f.value),Z.value.setScrollTop(Je),M.error("没有新的相关消息")}).catch(d=>{console.log(d)}):R({url:"#/api/v1/public_chat/search_message",method:"post",data:JSON.stringify({token:u().token,type:c.value,team_id:u().currentTeam.id,receive_user_id:_(),group_id:_()*-1,time:$e.value,keyword:ie.value})}).then(d=>{let t=d.data.data.message_list;console.log(t);for(let o of t)ae.value.unshift(o);if(t.length!==0&&($e.value=ae.value[0].time),t.length!==0){let o,s=5;o=setInterval(()=>{s--,s<=0&&(_e.value=Z.value.wrapRef.scrollHeight,Z.value.setScrollTop(_e.value-we.value),M.success("刷新成功"),clearInterval(o))},1)}else Z.value.setScrollTop(Je),M.error("没有新信息")}))});function Be(v){T.commit("goTemplate",v)}const ve=l([]);function Re(){console.log(k()),c.value===1?ve.value=JSON.parse(JSON.stringify(k())):c.value===2?ve.value=[]:R({url:"#/api/v1/public_chat/group/get_group_member_list",method:"post",data:JSON.stringify({token:u().token,group_id:_()*-1})}).then(v=>{ve.value=[];let N=v.data.data;for(let d of N)ve.value.push({id:d.user_id,name:d.user_name,avatar:d.user_avatar,status:d.status})}).catch(v=>{console.log(v)})}const ue=l(!1);return(v,N)=>{const d=Y("el-popover"),t=Y("el-icon"),o=Y("el-scrollbar"),s=Y("el-upload"),w=Y("el-input"),P=Y("el-dialog");return r(),S(K,null,[e("div",fs,[W(O(be.value)+" ",1),n(d,{trigger:"click",placement:"left-end",width:300},{reference:g(()=>[n(t,{class:"more-icon",onClick:Re},{default:g(()=>[n(F(nt))]),_:1})]),default:g(()=>[e("div",hs,[ys,(r(!0),S(K,null,le(ve.value,(i,oe)=>(r(),S("div",{key:oe,class:"more-block"},[n(d,{width:300,placement:"left-start","popper-style":"box-shadow: rgb(14 18 22 / 35%) 0px 10px 38px -10px, rgb(14 18 22 / 20%) 0px 10px 20px -15px; padding: 20px;",trigger:"click"},{reference:g(()=>[e("div",bs,[e("img",{class:"more-avatar-img",src:i.avatar,alt:""},null,8,ks)])]),default:g(()=>[e("div",Ss,[e("div",$s,[e("img",{style:{"margin-bottom":"8px"},src:i.avatar,class:"show-img",alt:""},null,8,ws)]),e("div",xs,[e("ul",Cs,[e("li",Ts,"昵称："+O(i.nickname),1),e("li",Is,"姓名："+O(i.name),1),e("li",Ns,"身份：团队"+O(i.status),1),e("li",Ms,"邮件："+O(i.email),1)])]),Js,Os])]),_:2},1024),e("div",Ls,O(i.name),1)]))),128)),n(d,{placement:"bottom",width:200,trigger:"click"},{reference:g(()=>[e("div",Us,[n(t,null,{default:g(()=>[n(F(Ye),{class:"more-icon-circle"})]),_:1}),Ds])]),default:g(()=>[(r(!0),S(K,null,le(q.value,(i,oe)=>(r(),S("div",{key:oe,class:"at-block"},[ve.value.indexOf(i)===-1?(r(),S(K,{key:0},[Rs,e("div",Hs,O(i.name),1)],64)):A("",!0)]))),128))]),_:1}),e("div",{class:"more-record",onClick:N[0]||(N[0]=i=>he.value=!0)},[W(" 聊天记录 "),n(t,null,{default:g(()=>[n(F(ot),{class:"more-icon-arrow"})]),_:1})])])]),_:1})]),e("div",Vs,[n(o,{style:{"max-height":"100%",height:"625px","min-height":"200px","border-bottom":"1.5px solid rgb(220, 220, 220)"},"wrap-class":"scroll-wrap",ref_key:"scrollContainer",ref:y,onScroll:L},{default:g(()=>[e("div",As,[e("div",zs,[n(t,{class:"is-loading"},{default:g(()=>[n(F(xe))]),_:1})]),(r(!0),S(K,null,le(a.value,(i,oe)=>(r(),S("div",{key:oe,class:"rightContainer"},[i.sender_id===$.value&&i.file_content==""?(r(),E(qe,{key:0,content:i.content,avatar:i.sender_avatar,sender:i.sender_name},null,8,["content","avatar","sender"])):A("",!0),i.sender_id!==$.value&&i.file_content==""?(r(),E(We,{key:1,content:i.content,avatar:i.sender_avatar,sender:i.sender_name},null,8,["content","avatar","sender"])):A("",!0),i.sender_id===$.value&&i.file_content!==""&&i.content==="true"?(r(),E(Ke,{key:2,content:i.file_content,avatar:i.sender_avatar,sender:i.sender_name},null,8,["content","avatar","sender"])):A("",!0),i.sender_id===$.value&&i.file_content!==""&&i.content==="false"?(r(),E(Qe,{key:3,content:i.file_content,avatar:i.sender_avatar,sender:i.sender_name},null,8,["content","avatar","sender"])):A("",!0),i.sender_id!==$.value&&i.file_content!==""&&i.content==="true"?(r(),E(Xe,{key:4,content:i.file_content,avatar:i.sender_avatar,sender:i.sender_name},null,8,["content","avatar","sender"])):A("",!0),i.sender_id!==$.value&&i.file_content!==""&&i.content==="false"?(r(),E(Ze,{key:5,content:i.file_content,avatar:i.sender_avatar,sender:i.sender_name},null,8,["content","avatar","sender"])):A("",!0)]))),128))])]),_:1},512),e("div",null,[n(s,{ref_key:"upLoads",ref:ne,class:"avatar-uploader",action:tt,"http-request":Ve,"on-change":Le,"show-file-list":!1,"before-upload":De},{trigger:g(()=>[n(t,{style:{"font-size":"25px","margin-left":"30px","margin-top":"10px"}},{default:g(()=>[n(F(lt))]),_:1})]),default:g(()=>[n(t,{style:{"font-size":"25px","margin-left":"20px","margin-top":"10px"}},{default:g(()=>[n(F(rt),{onClick:ye,style:{cursor:"pointer"}})]),_:1}),n(d,{visible:se.value,placement:"top-start",width:200},{reference:g(()=>[n(F(Se),{icon:["fas","at"],style:{"font-size":"23px","margin-left":"20px","margin-bottom":"3px"}})]),default:g(()=>[e("div",{class:"at-block",onClick:N[1]||(N[1]=i=>D({name:"所有人",id:0}))},"所有人"),(r(!0),S(K,null,le(ve.value.filter(i=>i.id!==Q.value),(i,oe)=>(r(),S("div",{onClick:ke=>D(i),key:oe,class:"at-block"},[e("div",Bs,[e("img",{style:{height:"30px",width:"30px","border-radius":"50%"},src:i.avatar,alt:"Avatar"},null,8,Fs)]),e("div",Gs,O(i.name),1)],8,Ps))),128))]),_:1},8,["visible"])]),_:1},512)]),e("div",null,[n(w,{type:"textarea",rows:6,placeholder:"请输入内容",modelValue:x.content,"onUpdate:modelValue":N[2]||(N[2]=i=>x.content=i),resize:"none",style:{position:"relative",top:"5px"}},null,8,["modelValue"]),e("div",{class:"send",onClick:h}," 发送 ")])]),n(P,{modelValue:he.value,"onUpdate:modelValue":N[4]||(N[4]=i=>he.value=i),width:"40%","before-close":de},{header:g(()=>[e("div",Es,O(be.value),1)]),default:g(()=>[n(w,{modelValue:ie.value,"onUpdate:modelValue":N[3]||(N[3]=i=>ie.value=i),placeholder:"请输入搜索内容",clearable:"",style:{"font-size":"16px",position:"relative",top:"-20px"},size:"large"},{append:g(()=>[n(t,null,{default:g(()=>[n(F(it),{onClick:Pe,circle:"",style:{cursor:"pointer"}})]),_:1})]),_:1},8,["modelValue"]),n(o,{style:{"max-height":"100%",height:"600px","min-height":"200px","border-bottom":"1.5px solid rgb(220, 220, 220)"},"wrap-class":"scroll-wrap",ref_key:"scrollSearchContainer",ref:Z,onScroll:re},{default:g(()=>[e("div",js,[e("div",Ys,[n(t,{class:"is-loading"},{default:g(()=>[n(F(xe))]),_:1})]),(r(!0),S(K,null,le(ae.value,(i,oe)=>(r(),S("div",{key:oe,class:"record-block",onMouseenter:ke=>i.record_visible=!0,onMouseleave:ke=>i.record_visible=!1},[e("div",Ws,[e("div",Ks,[e("img",{style:{height:"30px",width:"30px","border-radius":"50%"},src:i.sender_avatar,alt:"Avatar"},null,8,Qs)])]),e("div",Xs,[e("div",Zs,O(i.time),1),e("div",en,O(i.sender_name),1),tn,i.file_content!=""&&i.content=="true"?(r(),S("div",an,"[图片]")):i.file_content!=""&&i.content=="false"?(r(),S("div",sn,"[文件] ")):(r(),S("div",nn,O(i.content),1)),i.record_visible?(r(),S("div",{key:3,class:"record-go",onClick:ke=>Be(i)},"查看上下文",8,on)):A("",!0)])],40,qs))),128))])]),_:1},512)]),_:1},8,["modelValue"])],64)}}},rn=ce(ln,[["__scopeId","data-v-21c304b7"]]);const dt=I=>(me("data-v-2a756afe"),I=I(),fe(),I),cn={class:"name"},un={key:0,class:"recent"},dn={key:0},_n={key:1,class:"recent"},vn=dt(()=>e("span",{style:{color:"rgb(49, 28, 75)"}},"AgileLink,愿为天下千千结始",-1)),pn=[vn],gn={class:"name"},mn={key:0,class:"recent"},fn={key:0},hn={key:1,class:"recent"},yn=dt(()=>e("span",{style:{color:"rgb(201,17,198)"}},"AgileLink,愿为天下千千结始",-1)),bn=[yn],kn={__name:"messageBar",props:{id:Number},setup(I){const L=I,J=Ce(),c=l(null),T=l(!1),$=Te({message_num:0,newMessage:B().newMessage.content,name:B().name,sender:""});X(()=>f(),(G,a)=>{G===L.id?T.value=!0:T.value=!1}),B().newMessage.content!==""&&($.message_num=B().message_num,$.newMessage=B().newMessage.content,$.name=B().name,$.sender=B().newMessage.sender_name),X(()=>B(),(G,a)=>{$.message_num=B().message_num,$.newMessage=B().newMessage.content,$.name=B().name,$.sender=B().newMessage.sender_name});function y(){J.commit("changeCurrent",L.id)}function f(){return J.state.Chat.currentChatID}function B(){for(let G of J.getters.getChats)if(G.id===L.id)return G}return(G,a)=>{const b=Y("el-avatar"),V=Y("el-badge");return r(),S(K,null,[$.message_num>0?(r(),E(V,{key:0,value:$.message_num,class:"item",onClick:a[0]||(a[0]=j=>y())},{default:g(()=>[e("li",null,[n(b,{icon:F(je),size:50,style:{"margin-left":"10px","margin-top":"13px","font-size":"25px",position:"absolute"}},null,8,["icon"]),e("div",cn,O($.name),1),$.newMessage!==""?(r(),S("div",un,[L.id===0?(r(),S("span",dn,O($.sender)+":",1)):A("",!0),W(" "+O($.newMessage.slice(0,15-$.sender.length)+($.newMessage.length+$.sender.length<=15?"":"...")),1)])):(r(),S("div",_n,pn))])]),_:1},8,["value"])):A("",!0),$.message_num<=0?(r(),S("li",{key:1,onClick:a[1]||(a[1]=j=>y()),ref_key:"messageBar",ref:c,class:pt({messageSelect:T.value})},[n(b,{icon:F(je),size:50,style:{"margin-left":"10px","margin-top":"13px","font-size":"25px",position:"absolute"}},null,8,["icon"]),e("div",gn,O($.name),1),$.newMessage!==""?(r(),S("div",mn,[L.id===0?(r(),S("span",fn,O($.sender)+":",1)):A("",!0),W(" "+O($.newMessage.slice(0,15-$.sender.length)+($.newMessage.length+$.sender.length<=15?"":"...")),1)])):(r(),S("div",hn,bn))],2)):A("",!0)],64)}}},Ee=ce(kn,[["__scopeId","data-v-2a756afe"]]);const Sn={class:"name"},$n={key:0,class:"recent"},wn={class:"notice-dialog-container"},xn={class:"dialog-footer"},Cn={class:"notice-dialog-container"},Tn={class:"dialog-footer"},In={class:"notice-dialog-container"},Nn={class:"dialog-footer"},Mn={__name:"noticeBar",props:{id:Number},setup(I){const L=I,J=Ce(),c=l(""),T=l(null),$=l(null),y=gt();Oe(()=>{switch(a().type){case 1:c.value="收到团队邀请";break;case 2:c.value="邀请结果";break;case 3:c.value="收到加入申请";break;case 4:c.value="申请结果";break;case 5:c.value="权限变更";break;case 6:c.value="权限变更";break;case 7:c.value="被踢出团队";break;case 8:c.value="聊天中被提到";break;case 9:c.value="聊天中被提到";break;case 10:c.value="文档中被提到",console.log(a()),$.value={document_id:a().doc_source_id,document_name:a().doc_source_name},T.value={id:a().project_source_id,name:a().project_source_name};break;case 11:c.value="加入新群聊";break;case 12:c.value="聊天中被提到";break;case 13:c.value="聊天中被提到";break;case 14:c.value="群聊解散";break;case 15:c.value="退出群聊";break;default:c.value=""}f.name=c.value,f.message_num=0,f.newMessage=a().content});const f=Te({message_num:0,newMessage:"",name:""});function B(){J.commit("initDoc",$.value),J.commit("initProject",T.value),y.push("./doc")}const G=l("");function a(){for(let q of J.getters.getInfos)if(q.notice_id===L.id)return console.log(q),G.value=q.content,q;return G.value="",null}function b(){return J.getters.getUserinfo}function V(){a().message.type===1?a().message.receive_team_id===J.getters.getUserinfo.currentTeam.id?(J.commit("changeCurrent",0),J.commit("goTemplate",a().message)):M.error("该通知群组不属于当前团队，请前往其他团队查看"):a().message.type===3&&(a().message.receive_team_id===J.getters.getUserinfo.currentTeam.id?(J.commit("changeCurrent",a().message.receive_group_id*-1),J.commit("goTemplate",a().message)):M.error("该通知群组不属于当前团队，请前往其他团队查看")),U.value=!1}const j=l(!1),_=l(!1),U=l(!1);function u(){j.value=!1;const q=0;a().type===1?R({url:"#/api/v1/team_manage/invitee_handle_invitation",method:"post",data:JSON.stringify({token:b().token,team_id:a().team_id,if_agree:q,nickname:b().user_name})}).then(D=>{M.success("您已拒绝加入该团队！")}).catch(D=>{console.log(D)}):a().type===3&&R({url:"#/api/v1/team_manage/applicant_handle_application",method:"post",data:JSON.stringify({token:b().token,notice_id:a().notice_id,team_id:b().currentTeam.id,if_agree:q})}).then(D=>{M.success("您已拒绝该申请！")}).catch(D=>{console.log(D)}),J.commit("removeNotice",a())}function Q(){j.value=!1;const q=1;a().type===1?R({url:"#/api/v1/team_manage/invitee_handle_invitation",method:"post",data:JSON.stringify({token:b().token,team_id:a().team_id,if_agree:q,nickname:b().user_name})}).then(D=>{M.success("您已加入该团队！")}).catch(D=>{console.log(D)}):a().type===3&&R({url:"#/api/v1/team_manage/applicant_handle_application",method:"post",data:JSON.stringify({token:b().token,notice_id:a().notice_id,team_id:b.currentTeam.id,if_agree:q})}).then(D=>{M.success("您已同意该申请！")}).catch(D=>{console.log(D)}),J.commit("removeNotice",a())}function ee(){a()!=null&&(a().type===1||a().type===3?j.value=!0:a().type===2||a().type===4||a().type===5||a().type===6||a().type===7||a().type===11||a().type===14||a().type===15?_.value=!0:(a().type===8||a().type===9||a().type===10||a().type===12||a().type===13)&&(U.value=!0))}function x(){_.value=!1;const q=l([]);q.value.push(a().notice_id),R({url:"#/api/v1/notice_center/read_notice",method:"post",data:JSON.stringify({token:b().token,notice_id_list:q.value})}).then(D=>{J.commit("removeNotice",a())}).catch(D=>{console.log(D)})}function se(){a().type===10?(x(),B()):(V(),x())}return(q,D)=>{const m=Y("el-avatar"),k=Y("el-badge"),C=Y("el-button"),z=Y("el-dialog");return r(),S(K,null,[n(k,{"is-dot":"",class:"item",onClick:ee},{default:g(()=>[e("li",null,[n(m,{icon:F(je),size:50,style:{"margin-left":"10px","margin-top":"13px","font-size":"25px",position:"absolute"}},null,8,["icon"]),e("div",Sn,O(f.name),1),f.newMessage!==""?(r(),S("div",$n,O(f.newMessage.slice(0,15)+(f.newMessage.length<=15?"":"...")),1)):A("",!0)])]),_:1}),n(z,{modelValue:j.value,"onUpdate:modelValue":D[2]||(D[2]=h=>j.value=h),title:"通知",width:"30%"},{footer:g(()=>[e("span",xn,[n(C,{onClick:D[0]||(D[0]=h=>u())},{default:g(()=>[W("拒绝")]),_:1}),n(C,{type:"primary",style:{"background-color":"#1b9aee !important"},onClick:D[1]||(D[1]=h=>Q())},{default:g(()=>[W(" 同意 ")]),_:1})])]),default:g(()=>[e("div",wn,O(G.value),1)]),_:1},8,["modelValue"]),n(z,{modelValue:_.value,"onUpdate:modelValue":D[4]||(D[4]=h=>_.value=h),title:"通知",width:"30%"},{footer:g(()=>[e("span",Tn,[n(C,{type:"primary",style:{"background-color":"#1b9aee !important"},onClick:D[3]||(D[3]=h=>x())},{default:g(()=>[W(" 已读 ")]),_:1})])]),default:g(()=>[e("div",Cn,O(G.value),1)]),_:1},8,["modelValue"]),n(z,{modelValue:U.value,"onUpdate:modelValue":D[6]||(D[6]=h=>U.value=h),title:"通知",width:"30%"},{footer:g(()=>[e("span",Nn,[n(C,{type:"primary",style:{"background-color":"#1b9aee !important"},onClick:D[5]||(D[5]=h=>se())},{default:g(()=>[W(" 跳转至@ ")]),_:1})])]),default:g(()=>[e("div",In,O(G.value),1)]),_:1},8,["modelValue"])],64)}}},at=ce(Mn,[["__scopeId","data-v-f98f686e"]]);const Jn=I=>(me("data-v-6eabdee1"),I=I(),fe(),I),On={class:"float"},Ln={class:"header"},Rn={class:"header"},Hn={class:"header",style:{"margin-left":"15px"}},Un={key:0},Dn={key:1},Vn={key:2},An={key:3},zn={key:4},Pn={class:"dialog-footer"},Bn=Jn(()=>e("span",null,"是否一键已读所有通知消息？",-1)),Fn={class:"dialog-footer"},Gn={__name:"message",setup(I){const L=l(null),J=l(null),c=l("群组"),T=Ce();Oe(()=>{console.log($.value),$.value=B().sort((m,k)=>k.message_num-m.message_num),y.value=G().sort((m,k)=>k.type-m.type),console.log(y.value)});const $=l(B().sort((m,k)=>k.message_num-m.message_num)),y=l(G().sort((m,k)=>k.type-m.type)),f=l(!1);X(()=>T.state.Chat.fixedMessage,(m,k)=>{m!==null?f.value=!0:f.value=!1},{deep:!0}),X(()=>B(),(m,k)=>{$.value=m},{deep:!0}),X(()=>G(),(m,k)=>{y.value=G().sort((C,z)=>C.type-z.type)},{deep:!0});function B(){return T.getters.getChats}function G(){return console.log(T.getters.getInfos),T.getters.getInfos}function a(m){c.value=m}function b(){return T.getters.getUserinfo}const V=Te({name:"",introduction:""}),j=l(!1);function _(){V.group_introduction="",V.group_name="",j.value=!1}function U(){j.value=!0}function u(){R({url:"#/api/v1/public_chat/group/create_group",method:"post",data:JSON.stringify({token:b().token,team_id:b().currentTeam.id,group_name:V.name,group_introduction:V.introduction})}).then(m=>{if(console.log(m.data),m.data.errno===0){let k=m.data.data;T.commit("initChat",{id:k.group_id*-1,name:k.group_name,message_num:0,newMessage:{content:""}}),V.group_introduction="",V.group_name="",j.value=!1,M.success("创建成功")}}).catch(m=>{console.log(m)})}const Q=l(!0);function ee(){console.log(L.value.classList),L.value.classList.toggle("group_disappear"),J.value.classList.toggle("message_fold"),Q.value=!1}function x(){L.value.classList.remove("group_disappear"),J.value.classList.remove("message_fold"),Q.value=!0}const se=l(!1);function q(){D(),se.value=!1}function D(){const m=l([]),k=l([]);for(let C of T.getters.getInfos)(C.type===2||C.type===4||C.type===5||C.type===6||C.type===7||C.type===11||C.type===14||C.type===15)&&(m.value.push(C.notice_id),k.value.push(C));R({url:"#/api/v1/notice_center/read_notice",method:"post",data:JSON.stringify({token:b().token,notice_id_list:m.value})}).then(C=>{for(let z of k)T.commit("removeNotice",z)}).catch(C=>{console.log(C)})}return(m,k)=>{const C=Y("el-icon"),z=Y("el-input"),h=Y("el-button"),ne=Y("el-dialog");return r(),S(K,null,[e("div",On,[e("div",{class:"group",ref_key:"groupBar",ref:L},[Fe(e("div",Ln,[n(C,{class:"fold",onClick:ee},{default:g(()=>[n(F(mt))]),_:1}),W(" 分组 ")],512),[[Ge,Q.value]]),n(C,{class:"setting",onClick:U},{default:g(()=>[n(F(Ye))]),_:1}),e("ul",null,[e("li",{onClick:k[0]||(k[0]=H=>a("消息"))},[n(F(Se),{icon:["far","comment-dots"],style:{position:"relative",top:"5px","font-size":"23px","margin-left":"16px","margin-right":"8px"}}),W("消息 ")]),e("li",{onClick:k[1]||(k[1]=H=>a("未读"))},[n(F(Se),{icon:["far","comment"],style:{position:"relative",top:"5px","font-size":"23px","margin-left":"16px","margin-right":"8px"}}),W("未读 ")]),e("li",{onClick:k[2]||(k[2]=H=>a("@我"))},[n(F(Se),{icon:["fas","at"],style:{position:"relative",top:"5px","font-size":"23px","margin-left":"16px","margin-right":"8px"}}),W("我 ")]),e("li",{onClick:k[3]||(k[3]=H=>a("单聊"))},[n(F(Se),{icon:["fas","user"],style:{position:"relative",top:"5px","font-size":"23px","margin-left":"17px","margin-right":"8px"}}),W("单聊 ")]),e("li",{onClick:k[4]||(k[4]=H=>a("群组"))},[n(F(Se),{icon:["fas","user-group"],style:{position:"relative",top:"5px","font-size":"23px","margin-left":"9px","margin-right":"8px"}}),W("群组 ")])])],512),e("div",{class:"message",ref_key:"messageBar",ref:J},[Fe(e("div",Rn,[n(C,{class:"fold",onClick:x},{default:g(()=>[n(F(ft))]),_:1}),W(" "+O(c.value),1)],512),[[Ge,!Q.value]]),Fe(e("div",Hn,[W(O(c.value)+" ",1),n(C,{class:"select",onClick:k[5]||(k[5]=H=>se.value=!0)},{default:g(()=>[n(F(ht))]),_:1})],512),[[Ge,Q.value]]),c.value==="群组"?(r(),S("ul",Un,[(r(!0),S(K,null,le($.value.filter(function(H){return H.id<=0}),(H,te)=>(r(),E(Ee,{key:te,id:H.id},null,8,["id"]))),128))])):A("",!0),c.value==="单聊"?(r(),S("ul",Dn,[(r(!0),S(K,null,le($.value.filter(function(H){return H.id>0}),(H,te)=>(r(),E(Ee,{key:te,id:H.id},null,8,["id"]))),128))])):A("",!0),c.value==="未读"?(r(),S("ul",Vn,[(r(!0),S(K,null,le($.value.filter(function(H){return H.message_num>0}),(H,te)=>(r(),E(Ee,{key:te,id:H.id},null,8,["id"]))),128))])):A("",!0),c.value==="消息"?(r(),S("ul",An,[(r(!0),S(K,null,le(y.value,(H,te)=>(r(),E(at,{key:te,id:H.notice_id},null,8,["id"]))),128))])):A("",!0),c.value==="@我"?(r(),S("ul",zn,[(r(!0),S(K,null,le(y.value.filter(H=>H.type===8),(H,te)=>(r(),E(at,{key:te,id:H.notice_id},null,8,["id"]))),128))])):A("",!0)],512),Q.value&&!f.value?(r(),E(is,{key:0,style:{width:"calc(100vw - 600px)","min-width":"350px"}})):A("",!0),Q.value&&f.value?(r(),E(gs,{key:1,style:{width:"calc(100vw - 600px)","min-width":"350px"}})):A("",!0),Q.value?A("",!0):(r(),E(rn,{key:2,style:{width:"calc(100vw - 600px)","min-width":"350px"}}))]),n(ne,{modelValue:j.value,"onUpdate:modelValue":k[8]||(k[8]=H=>j.value=H),title:"创建群聊",width:"30%","before-close":_,style:{"border-radius":"20px"}},{footer:g(()=>[e("span",Pn,[n(h,{onClick:_,style:{width:"50px"}},{default:g(()=>[W("取消")]),_:1}),n(h,{type:"primary",onClick:u,style:{width:"50px","background-color":"#1b9aee !important"}},{default:g(()=>[W(" 确定 ")]),_:1})])]),default:g(()=>[n(z,{modelValue:V.name,"onUpdate:modelValue":k[6]||(k[6]=H=>V.name=H),placeholder:"请输入新的群组名称",clearable:"",maxlength:"20",style:{"font-size":"16px","margin-bottom":"15px"}},null,8,["modelValue"]),n(z,{modelValue:V.introduction,"onUpdate:modelValue":k[7]||(k[7]=H=>V.introduction=H),placeholder:"请输入新的群组介绍",clearable:"",maxlength:"20",style:{"font-size":"16px"}},null,8,["modelValue"])]),_:1},8,["modelValue"]),n(ne,{modelValue:se.value,"onUpdate:modelValue":k[11]||(k[11]=H=>se.value=H),title:"一键已读",width:"30%"},{footer:g(()=>[e("span",Fn,[n(h,{onClick:k[9]||(k[9]=H=>se.value=!1),style:{width:"50px"}},{default:g(()=>[W("取消")]),_:1}),n(h,{type:"primary",style:{"background-color":"#1b9aee !important",width:"50px"},onClick:k[10]||(k[10]=H=>q())},{default:g(()=>[W(" 确认 ")]),_:1})])]),default:g(()=>[Bn]),_:1},8,["modelValue"])],64)}}},Yn=ce(Gn,[["__scopeId","data-v-6eabdee1"]]);export{Yn as default};
